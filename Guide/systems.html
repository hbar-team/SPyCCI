

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Defining molecular systems &mdash; SPyCCI User Guide</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=d23eb610" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script src="../_static/scripts/sphinx-book-theme.js"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script src="../_static/design-tabs.js?v=f930bc37"></script>
      <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
      <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
      <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Setting up calculations" href="setup.html" />
    <link rel="prev" title="User guide" href="../user-guide.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../intro.html">
            
              <img src="../_static/SPyCCI_logo_tr-01.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../user-guide.html">User guide</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Defining molecular systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="setup.html">Setting up calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="run.html">Running calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="functions.html">Calculating properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html">Useful tools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributor-guide.html">Contributor’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-notes.html">Release notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../intro.html">Project name not set</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../intro.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../user-guide.html">User guide</a></li>
      <li class="breadcrumb-item active">Defining molecular systems</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/Guide/systems.md" rel="nofollow"> View page source</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="../user-guide.html" class="btn btn-neutral float-left" title="User guide" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="setup.html" class="btn btn-neutral float-right" title="Setting up calculations" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="defining-molecular-systems">
<span id="guide-systems"></span><h1>Defining molecular systems<a class="headerlink" href="#defining-molecular-systems" title="Link to this heading"></a></h1>
<p>Before diving into any computational chemistry simulation, you need to answer two key questions: <em>What</em> are you studying, and <em>what</em> do you want to do with it? In other words, you have to define the <em>system</em> and the type of calculation that you need to run.</p>
<p>To help with the first part, describing the system, the <code class="docutils literal notranslate"><span class="pre">spycci.systems</span></code> submodule has you covered.</p>
<p>This submodule provides a set of classes designed to organize and store information about the chemical system you’re working with. Currently the following objects have been implemented:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#system-section"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">System</span></code>: a general-purpose object representing a single molecular system or aggregates.</span></a></p></li>
<li><p><a class="reference internal" href="#ensamble-section"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">Ensemble</span></code>: a collection of closely related <code class="docutils literal notranslate"><span class="pre">System</span></code> objects.</span></a> For example, a set of conformers generated by the <strong>CREST</strong> tool.</p></li>
</ul>
<p>You can bring these classes into your project using the syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">spycci.systems</span><span class="w"> </span><span class="kn">import</span> <span class="n">System</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">spycci.systems</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ensemble</span>
</pre></div>
</div>
<p>In this section of the guide, we’ll show you how to define molecular systems using these classes, their features and the most useful mode of operation.</p>
<hr class="docutils" />
<section id="single-systems">
<span id="system-section"></span><h2>Single systems<a class="headerlink" href="#single-systems" title="Link to this heading"></a></h2>
<p>A <code class="docutils literal notranslate"><span class="pre">System</span></code> object represents a molecular system containing one or more individual molecules. A <code class="docutils literal notranslate"><span class="pre">System</span></code> object, as a real molecular system, is defined by a series of attributes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code>: the name of the system.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">geometry</span></code>: the 3D molecular geometry of the system encoding the position of each atom.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">charge</span></code>: the total charge of the system.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spin</span></code>: the spin multiplicity of the system as <span class="math notranslate nohighlight">\(2S+1\)</span>, where <span class="math notranslate nohighlight">\(S\)</span> is the total spin quantum number.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">box_size</span></code>: for periodic systems the size of the cubic periodic boundary conditions box.</p></li>
</ul>
<p>Furthermore each system is associated with a set of <code class="docutils literal notranslate"><span class="pre">properties</span></code> that are usually set and accessed during computational chemistry calculations and workflows. We will cover these in subsequent chapters of this user guide.</p>
<section id="loading-data-from-an-xyz-file">
<h3>Loading data from an <code class="docutils literal notranslate"><span class="pre">.xyz</span></code> file<a class="headerlink" href="#loading-data-from-an-xyz-file" title="Link to this heading"></a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">System</span></code> object can be initialized in various ways the most common of which is that of providing a molecular structure via a <code class="docutils literal notranslate"><span class="pre">.xyz</span></code> file. This can be done using the <code class="docutils literal notranslate"><span class="pre">from_xyz()</span></code> classmethod. In the following example a system object, containing the structure of the water molecule, is loaded from the <code class="docutils literal notranslate"><span class="pre">water.xyz</span></code> file and some of its properies are printed:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">spycci.systems</span><span class="w"> </span><span class="kn">import</span> <span class="n">System</span>

<span class="c1"># Create a System object for a neutral water molecule from a `.xyz` file</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="n">from_xyz</span><span class="p">(</span><span class="s2">&quot;../example_files/water.xyz&quot;</span><span class="p">)</span>

<span class="c1"># Print some attributes</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Name: </span><span class="si">{</span><span class="n">mol</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Charge: </span><span class="si">{</span><span class="n">mol</span><span class="o">.</span><span class="n">charge</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Spin multiplicity: </span><span class="si">{</span><span class="n">mol</span><span class="o">.</span><span class="n">spin</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of atoms: </span><span class="si">{</span><span class="n">mol</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">atomcount</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Atoms list: </span><span class="si">{</span><span class="n">mol</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">atoms</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Name: water
Charge: 0
Spin multiplicity: 1
Number of atoms: 3
Atoms list: [&#39;O&#39;, &#39;H&#39;, &#39;H&#39;]
</pre></div>
</div>
</div>
</div>
<p>Please notice how the <code class="docutils literal notranslate"><span class="pre">name</span></code> of the molecule has been set using the path basename stripping the <code class="docutils literal notranslate"><span class="pre">.xyz</span></code> file extension and the unspecified attributes have been set to default values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">charge</span></code>: total charge of the system. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code>(not charged)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spin</span></code>: total spin multiplicity of the system. Default: <code class="docutils literal notranslate"><span class="pre">1</span></code> (singlet)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">box_side</span></code>: length of the cubic simulation box (in <span class="math notranslate nohighlight">\(\mathrm{Å}\)</span>). Default: <code class="docutils literal notranslate"><span class="pre">None</span></code> (non periodic)</p></li>
</ul>
<p>These can of course be specified explicilty in the constructor when needed. For example, a periodic system of side <span class="math notranslate nohighlight">\(\mathrm{18.27Å}\)</span> containing a radical cation can be defined according to:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">spycci.systems</span><span class="w"> </span><span class="kn">import</span> <span class="n">System</span>
<span class="n">my_mol</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="n">from_xyz</span><span class="p">(</span>
    <span class="s2">&quot;path/to/xyz/water.xyz&quot;</span><span class="p">,</span> 
    <span class="n">charge</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
    <span class="n">spin</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">box_side</span><span class="o">=</span><span class="mf">18.27</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="creating-a-system-object-form-a-smiles-string">
<h3>Creating a <code class="docutils literal notranslate"><span class="pre">System</span></code> object form a SMILES string<a class="headerlink" href="#creating-a-system-object-form-a-smiles-string" title="Link to this heading"></a></h3>
<p>Another convenient way to initialize a <code class="docutils literal notranslate"><span class="pre">System</span></code> object is that of using <strong>S</strong>implified <strong>M</strong>olecular <strong>I</strong>nput <strong>L</strong>ine <strong>E</strong>ntry <strong>S</strong>ystem (SMILES) strings. This can be done using the <code class="docutils literal notranslate"><span class="pre">form_smiles</span></code> class method providing both a <code class="docutils literal notranslate"><span class="pre">name</span></code> for the system and the SMILES string. As an example the <code class="docutils literal notranslate"><span class="pre">System</span></code> object representing a ethanol molecule can be derived from is smile <code class="docutils literal notranslate"><span class="pre">CCO</span></code> according to:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">spycci.systems</span><span class="w"> </span><span class="kn">import</span> <span class="n">System</span>

<span class="n">mol</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="n">from_smiles</span><span class="p">(</span><span class="s2">&quot;ethanol&quot;</span><span class="p">,</span> <span class="s2">&quot;CCO&quot;</span><span class="p">)</span>

<span class="c1"># Print some attributes</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Name: </span><span class="si">{</span><span class="n">mol</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Charge: </span><span class="si">{</span><span class="n">mol</span><span class="o">.</span><span class="n">charge</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Spin multiplicity: </span><span class="si">{</span><span class="n">mol</span><span class="o">.</span><span class="n">spin</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of atoms: </span><span class="si">{</span><span class="n">mol</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">atomcount</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Atoms list: </span><span class="si">{</span><span class="n">mol</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">atoms</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Name: ethanol
Charge: 0
Spin multiplicity: 1
Number of atoms: 9
Atoms list: [&#39;C&#39;, &#39;C&#39;, &#39;O&#39;, &#39;H&#39;, &#39;H&#39;, &#39;H&#39;, &#39;H&#39;, &#39;H&#39;, &#39;H&#39;]
</pre></div>
</div>
</div>
</div>
<p>The class constructor automatically adds implicit hydrogens to the structure, embeds it in the 3D space and runs a rough geometry optimization using either the <code class="docutils literal notranslate"><span class="pre">MMFF</span></code>s or the <code class="docutils literal notranslate"><span class="pre">UFF</span></code> force fields. Additional optional keywords that can be used to configure the SMILES translation process can be found in the <a class="reference internal" href="../API/systems.html#api-systems"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">System</span></code> object API</span></a>.</p>
</section>
<section id="saving-an-loading-a-system-to-and-form-a-json-file">
<h3>Saving an loading a <code class="docutils literal notranslate"><span class="pre">System</span></code> to and form a <code class="docutils literal notranslate"><span class="pre">.json</span></code> file<a class="headerlink" href="#saving-an-loading-a-system-to-and-form-a-json-file" title="Link to this heading"></a></h3>
<p>Once created, a <code class="docutils literal notranslate"><span class="pre">System</span></code> object, together with all its computed properties and attributes, can be saved to a standardized <code class="docutils literal notranslate"><span class="pre">.json</span></code> file. This can be done using the method <code class="docutils literal notranslate"><span class="pre">save_json</span></code> providing the path to the destination file. The syntax of the command is simple and can be examined in the following example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">spycci.systems</span><span class="w"> </span><span class="kn">import</span> <span class="n">System</span>

<span class="n">mol</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="n">from_xyz</span><span class="p">(</span><span class="s2">&quot;water.xyz&quot;</span><span class="p">)</span>

<span class="c1"># ... SOME CALCULATION CAN BE DONE HERE ...</span>

<span class="n">mol</span><span class="o">.</span><span class="n">save_json</span><span class="p">(</span><span class="s2">&quot;water.json&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The saved <code class="docutils literal notranslate"><span class="pre">.json</span></code> file contains all the information of the <code class="docutils literal notranslate"><span class="pre">System</span></code> object and can be used to rebuild the same object at a later time. This can be done using the <code class="docutils literal notranslate"><span class="pre">from_json()</span></code> classmethod according to:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">spycci.systems</span><span class="w"> </span><span class="kn">import</span> <span class="n">System</span>

<span class="n">mol</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="s2">&quot;water.json&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=========================================================
SYSTEM: water
=========================================================

Number of atoms: 3
Charge: 0
Spin multiplicity: 1

********************** GEOMETRY *************************

Total system mass: 18.0153 amu

----------------------------------------------
 index  atom    x (Å)      y (Å)      z (Å)   
----------------------------------------------
 0       O     0.00000   -0.37937    0.00000  
 1       H     0.77221    0.18968   -0.00000  
 2       H    -0.77221    0.18969    0.00000  
----------------------------------------------

********************** PROPERTIES *************************

Geometry level of theory: XtbInput || method: gfn2 | solvent: None
Electronic level of theory: XtbInput || method: gfn2 | solvent: None
Vibronic level of theory: XtbInput || method: gfn2 | solvent: None

Electronic energy: -5.070544446692 Eh
Gibbs free energy correction G-E(el): 0.002508973529 Eh
Gibbs free energy: -5.0680354731629995 Eh
pKa: pKa object status is NOT SET


MULLIKEN ANALYSIS
----------------------------------------------
 index  atom   charge    spin
----------------------------------------------
 0       O    -0.56500  0.00000  
 1       H    0.28200   0.00000  
 2       H    0.28200   0.00000  
</pre></div>
</div>
</div>
</div>
</section>
<section id="creating-a-system-manually-from-coordinates">
<h3>Creating a <code class="docutils literal notranslate"><span class="pre">System</span></code> manually from coordinates<a class="headerlink" href="#creating-a-system-manually-from-coordinates" title="Link to this heading"></a></h3>
<p>The most basic approach to create a <code class="docutils literal notranslate"><span class="pre">System</span></code> object is that of manually entering the coordinates of each atom in the molecule. This approach is rarely used by the computational chemistry practitioner but, not involving the use of external files, finds large applications in developing new library features. The workflow is quite simple an involves the creation of a <a class="reference internal" href="../API/core.html#core-geometry-api"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">MolecularGeometry</span></code> object</span></a> that can be directly fed to the <code class="docutils literal notranslate"><span class="pre">System</span></code> constructor. As an example the following script can be used to generate a water molecule system directly from coordinates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">spycci.systems</span><span class="w"> </span><span class="kn">import</span> <span class="n">System</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">spycci.core.geometry</span><span class="w"> </span><span class="kn">import</span> <span class="n">MolecularGeometry</span>

<span class="n">WATER</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;O&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.02534</span><span class="p">,</span> <span class="mf">1.26595</span><span class="p">,</span> <span class="mf">0.01097</span><span class="p">],</span>
    <span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.05210</span><span class="p">,</span> <span class="mf">1.22164</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01263</span><span class="p">],</span>
    <span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.30240</span><span class="p">,</span> <span class="mf">0.44124</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.42809</span><span class="p">],</span>
<span class="p">]</span>

<span class="c1"># Creating a MolecularGeometry onject</span>
<span class="n">water</span> <span class="o">=</span> <span class="n">MolecularGeometry</span><span class="p">()</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">WATER</span><span class="p">:</span>
    <span class="n">water</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">::])</span>

<span class="c1"># Creating the `System` object from the generated geometry</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">System</span><span class="p">(</span><span class="s2">&quot;water&quot;</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">water</span><span class="p">)</span>

<span class="c1"># Print some attributes</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Name: </span><span class="si">{</span><span class="n">mol</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Charge: </span><span class="si">{</span><span class="n">mol</span><span class="o">.</span><span class="n">charge</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Spin multiplicity: </span><span class="si">{</span><span class="n">mol</span><span class="o">.</span><span class="n">spin</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of atoms: </span><span class="si">{</span><span class="n">mol</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">atomcount</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Atoms list: </span><span class="si">{</span><span class="n">mol</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">atoms</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Name: water
Charge: 0
Spin multiplicity: 1
Number of atoms: 3
Atoms list: [&#39;O&#39;, &#39;H&#39;, &#39;H&#39;]
</pre></div>
</div>
</div>
</div>
<p>Please notice how this approach is the only one relaying directly on the <code class="docutils literal notranslate"><span class="pre">__init__</span></code> method of the <code class="docutils literal notranslate"><span class="pre">System</span></code> class. In fact, all the classmethods explored so far simply generate a <code class="docutils literal notranslate"><span class="pre">MolecularGeometry</span></code> object that is then fed to the <code class="docutils literal notranslate"><span class="pre">__init__</span></code> method.</p>
<hr class="docutils" />
</section>
</section>
<section id="ensembles">
<span id="ensamble-section"></span><h2>Ensembles<a class="headerlink" href="#ensembles" title="Link to this heading"></a></h2>
<p>An <code class="docutils literal notranslate"><span class="pre">Ensemble</span></code> object is defined as a collection of related <code class="docutils literal notranslate"><span class="pre">Systems</span></code>, for example the collection of lowest-energy conformers generated by <a class="reference internal" href="../API/wrappers/crest.html#api-wrappers-crest"><span class="std std-ref">CREST</span></a>. To initialise an <code class="docutils literal notranslate"><span class="pre">Ensemble</span></code> object you need to provide an <code class="docutils literal notranslate"><span class="pre">iterable</span></code> (such as a list) yielding <code class="docutils literal notranslate"><span class="pre">System</span></code> objects:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">spycci.systems</span><span class="w"> </span><span class="kn">import</span> <span class="n">System</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">spycci.systems</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ensemble</span>

<span class="n">my_mol1</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="n">from_xyz</span><span class="p">(</span><span class="s2">&quot;path/to/xyz/my_mol1.xyz&quot;</span><span class="p">)</span>
<span class="n">my_mol2</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="n">from_xyz</span><span class="p">(</span><span class="s2">&quot;path/to/xyz/my_mol2.xyz&quot;</span><span class="p">)</span>
<span class="n">my_mol3</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="n">from_xyz</span><span class="p">(</span><span class="s2">&quot;path/to/xyz/my_mol3.xyz&quot;</span><span class="p">)</span>

<span class="n">my_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">my_mol1</span><span class="p">,</span> <span class="n">my_mol2</span><span class="p">,</span> <span class="n">my_mol3</span><span class="p">]</span>

<span class="n">my_ens</span> <span class="o">=</span> <span class="n">Ensemble</span><span class="p">(</span><span class="n">my_list</span><span class="p">)</span>
</pre></div>
</div>
<p>To get a list of all the available properties, please refer to the <a class="reference internal" href="../API/systems.html#api-systems"><span class="std std-ref">API</span></a>.</p>
<!-- 
---

## Molecular Dynamics Trajectories

:::{admonition} Note
:class: info
This is still very much WIP! Expect the following content to possibly be changed significantly with future updates!
:::

An `MDTrajectory` object is conceptually an `Ensemble` generated by a Molecular Dynamics (MD) trajectory. Currently, only [DFTB+](API-wrappers-dftbplus) MD are supported. `MDTrajectory` objects are initialised by providing the path `prefix` to the `<prefix>_md.out` file storing the energy information and `<prefix>_geo_end.xyz` file storing the coordinate information, and the level of theory at which the DFTB+ simulation was ran:

```python
from spycci.systems import MDTrajectory

# note, the following files must exist:
# path/to/xyz/my_traj_md.out
# path/to/xyz/my_traj_geo_end.xyz
my_traj = MDTrajectory("path/to/xyz/my_traj", "gfn2")
```

The primary intended use for this class is as an on-the-fly generator of `System` objects corresponding to the requested frame of the MD simulation. 

Examples:

* Extract the last frame of the MD simulation as a System object:
```python
last_frame = my_traj[-1]
```
* Cycle over all frames and export the corresponding .xyz files:
```python
for frame in my_traj:
    frame.write_xyz(frame.name)
```

Note: individual "frames" are automatically internally renamed according to the corresponding step/index of the MD simulation.  --></section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Guide"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>