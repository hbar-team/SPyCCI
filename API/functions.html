

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>spycci.functions sub-module &mdash; SPyCCI User Guide</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=d23eb610" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script src="../_static/scripts/sphinx-book-theme.js"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script src="../_static/design-tabs.js?v=f930bc37"></script>
      <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
      <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="spycci.tools sub-module" href="tools.html" />
    <link rel="prev" title="spycci.wrappers.packmol sub-module" href="wrappers/packmol.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../intro.html">
            
              <img src="../_static/SPyCCI_logo_tr-01.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user-guide.html">User guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="core.html"><code class="docutils literal notranslate"><span class="pre">spycci.core</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="systems.html"><code class="docutils literal notranslate"><span class="pre">spycci.systems</span></code> sub-module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wrappers.html"><code class="docutils literal notranslate"><span class="pre">spycci.engines</span></code> sub-module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wrappers.html#spycci-wrappers-sub-module"><code class="docutils literal notranslate"><span class="pre">spycci.wrappers</span></code> sub-module</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">spycci.functions</span></code> sub-module</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html"><code class="docutils literal notranslate"><span class="pre">spycci.tools</span></code> sub-module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributor-guide.html">Contributor’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-notes.html">Release notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../intro.html">Project name not set</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../intro.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../api.html">API Documentation</a></li>
      <li class="breadcrumb-item active"><code class="docutils literal notranslate"><span class="pre">spycci.functions</span></code> sub-module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/API/functions.md" rel="nofollow"> View page source</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="wrappers/packmol.html" class="btn btn-neutral float-left" title="spycci.wrappers.packmol sub-module" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tools.html" class="btn btn-neutral float-right" title="spycci.tools sub-module" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="spycci-functions-sub-module">
<span id="api-functions"></span><h1><code class="docutils literal notranslate"><span class="pre">spycci.functions</span></code> sub-module<a class="headerlink" href="#spycci-functions-sub-module" title="Link to this heading"></a></h1>
<section id="calculate-pka-function">
<h2><code class="docutils literal notranslate"><span class="pre">calculate_pka</span></code> function<a class="headerlink" href="#calculate-pka-function" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="spycci.functions.calculate_pka">
<span class="sig-prename descclassname"><span class="pre">spycci.functions.</span></span><span class="sig-name descname"><span class="pre">calculate_pka</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">protonated</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deprotonated</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_return</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spycci.functions.calculate_pka" title="Link to this definition"></a></dt>
<dd><p>Calculates the pKa of a molecule using the direct method. The function expects as arguments
the protonated and deprotonated forms of the molecule as a <cite>System</cite> objects for which the
energies must have already been computed. The function returns the computed pKa and sets (if
not otherwise indicated by the user) the pka property of the <cite>protonated</cite> system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>protonated</strong> (<a class="reference internal" href="systems.html#spycci.systems.System" title="spycci.systems.System"><em>System</em></a>) – molecule in the protonated form</p></li>
<li><p><strong>deprotonated</strong> (<a class="reference internal" href="systems.html#spycci.systems.System" title="spycci.systems.System"><em>System</em></a>) – molecule in the deprotonated form</p></li>
<li><p><strong>only_return</strong> (<em>bool</em>) – If set to True will not set the computed pKa value in the properties of the <cite>protonated</cite>
object. Else (default) the pKa property will be initialized using the <cite>DIRECT</cite> method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pKa</strong> – the pKa object encoding the pka of the molecule computed using the direct method.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="core.html#spycci.core.properties.pKa" title="spycci.core.properties.pKa">pKa</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="auto-calculate-pka-function">
<h2><code class="docutils literal notranslate"><span class="pre">auto_calculate_pka</span></code> function<a class="headerlink" href="#auto-calculate-pka-function" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="spycci.functions.auto_calculate_pka">
<span class="sig-prename descclassname"><span class="pre">spycci.functions.</span></span><span class="sig-name descname"><span class="pre">auto_calculate_pka</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">protonated</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method_el</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method_vib</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method_opt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxcore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">350</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spycci.functions.auto_calculate_pka" title="Link to this definition"></a></dt>
<dd><p>Automatically calculates the pKa of a given <cite>protonated</cite> molecule. The routine computes
all the deprotomers of the molecule using CREST, orders the deprotomers according to
their energy computed with a user-defined level of theory and calculates the pKa.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>protonated</strong> (<a class="reference internal" href="systems.html#spycci.systems.System" title="spycci.systems.System"><em>System</em></a>) – The protonated molecule for which the pKa must be computed</p></li>
<li><p><strong>method_el</strong> (<a class="reference internal" href="core.html#spycci.core.base.Engine" title="spycci.core.base.Engine"><em>Engine</em></a>) – The computational engine to be used in the electronic level of theory calculations</p></li>
<li><p><strong>method_vib</strong> (<a class="reference internal" href="core.html#spycci.core.base.Engine" title="spycci.core.base.Engine"><em>Engine</em></a><em> (</em><em>optional</em><em>)</em>) – The computational engine to be used in the vibrational level of theory calculations. If
set to None (default) the pKa will be computed without the free energy corrections (only electronic energy).</p></li>
<li><p><strong>method_opt</strong> (<a class="reference internal" href="core.html#spycci.core.base.Engine" title="spycci.core.base.Engine"><em>Engine</em></a><em> (</em><em>optional</em><em>)</em>) – The computational engine to be used in the geometry optimization of the protonated
molecule and its deprotomers. If set to None (default) will use xTB gfn2 and the
alpb solvent model for water.</p></li>
<li><p><strong>ncores</strong> (<em>int</em><em> (</em><em>optional</em><em>)</em>) – The number of cores to be used in the calculations. If set to None (default) will use
the maximun number of available cores.</p></li>
<li><p><strong>maxcore</strong> (<em>int</em><em> (</em><em>optional</em><em>)</em>) – For the engines that supprots it, the memory assigned to each core used in the
computation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>pKa</em> – pKa object computed for the molecule.</p></li>
<li><p><em>System</em> – the structure of the considered deprotomer.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[<a class="reference internal" href="core.html#spycci.core.properties.pKa" title="spycci.core.properties.pKa"><em>pKa</em></a>, <a class="reference internal" href="systems.html#spycci.systems.System" title="spycci.systems.System"><em>System</em></a>]</p>
</dd>
</dl>
</dd></dl>

</section>
<hr class="docutils" />
<section id="calculate-reduction-potential-function">
<h2><code class="docutils literal notranslate"><span class="pre">calculate_reduction_potential</span></code> function<a class="headerlink" href="#calculate-reduction-potential-function" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="spycci.functions.calculate_reduction_potential">
<span class="sig-prename descclassname"><span class="pre">spycci.functions.</span></span><span class="sig-name descname"><span class="pre">calculate_reduction_potential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">oxidised</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduced</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pH</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spycci.functions.calculate_reduction_potential" title="Link to this definition"></a></dt>
<dd><p>Calculates the reduction potential of a molecule, given the oxidized and reduced forms
assuming that energies have already been computed. The number of electrons exchanged in
the process is automatically computed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>oxidised</strong> (<em>System object</em>) – molecule in the oxidised state</p></li>
<li><p><strong>reduced</strong> (<em>System object</em>) – molecule in the reduced state</p></li>
<li><p><strong>pH</strong> (<em>float</em>) – pH at which the redox potential is evaluated, by default pH=7. This is important in
case of a proton-coupled electron transfer (PCET) redox process</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – Exception raised if either oxidised or reduced molecules are Ensembles</p></li>
<li><p><strong>RuntimeError</strong> – Exception raised if a mismatch is detected between electronic levels of theory.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>float</em> – reduction potential of the molecule.</p></li>
<li><p><em>int</em> – number of exchanged electrons</p></li>
<li><p><em>int</em> – number of exchanged protons</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Tuple</em>[float, int, int]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="calculate-fukui-function">
<h2><code class="docutils literal notranslate"><span class="pre">calculate_fukui</span></code> function<a class="headerlink" href="#calculate-fukui-function" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="spycci.functions.calculate_fukui">
<span class="sig-prename descclassname"><span class="pre">spycci.functions.</span></span><span class="sig-name descname"><span class="pre">calculate_fukui</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">engine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spins_states</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cube_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">CubeGrids.NORMAL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxcore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spycci.functions.calculate_fukui" title="Link to this definition"></a></dt>
<dd><p>Computes the Fukui f+, f- and f0 functions starting from a given input molecule. The
functions are saved in Gaussian cube compatible format and stored in the
<cite>output_densities</cite> folder. Localized Fukui functions are also computed from the Mulliken
and Hirshfeld charges and saved in the molecule properties. Please notice that the charges
in the <cite>.fukui.cube</cite> produced are replaced by the Mulliken condensed fukui functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<a class="reference internal" href="systems.html#spycci.systems.System" title="spycci.systems.System"><em>System</em></a>) – The System object containing the geometry of the selected molecule (if the geometry
has not been optimized, please enable the optimize option)</p></li>
<li><p><strong>orca</strong> (<a class="reference internal" href="core.html#spycci.core.base.Engine" title="spycci.core.base.Engine"><em>Engine</em></a>) – The engine object that defines the protocol to be used in the calculation.</p></li>
<li><p><strong>spin_states</strong> (<em>Union</em><em>[</em><em>None</em><em>, </em><em>List</em><em>[</em><em>int</em><em>]</em><em>]</em>) – If set to None, when adding or subtracting electrons will automatically switch the
spin state from singlet to doublet and vice versa (Maximum one unpaired electrons).
If manually set to <cite>List[int]</cite> will force the spin multeplicities according to the
user specified values. The order of the spin multiplicity values is: molecule with
one electron added (-1), the molecule as it is (0) and the molecule  with one of its
electrons removed (+1).</p></li>
<li><p><strong>cube_grid</strong> (<em>Union</em><em>[</em><em>CubeGrids</em><em>, </em><em>None</em><em>]</em>) – Resolution for the cube files (default Normal). If set to None the function will avoid
the generation of cube files and will only compute condensed fukui values.</p></li>
<li><p><strong>ncores</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of cores, by default all available cores (None)</p></li>
<li><p><strong>maxcore</strong> (<em>int</em>) – The maximum amount of memory in MB to be allocated for each core.</p></li>
<li><p><strong>engine</strong> (<a class="reference internal" href="wrappers/orca.html#spycci.engines.orca.OrcaInput" title="spycci.engines.orca.OrcaInput"><em>OrcaInput</em></a><em> | </em><a class="reference internal" href="wrappers/xtb.html#spycci.engines.xtb.XtbInput" title="spycci.engines.xtb.XtbInput"><em>XtbInput</em></a>)</p></li>
<li><p><strong>spins_states</strong> (<em>None</em><em> | </em><em>List</em><em>[</em><em>int</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./API"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>